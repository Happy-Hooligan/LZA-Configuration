###############################################################################################################
# Global Configuration for Landing Zone Accelerator on AWS                                                    #
# For additional configurable services, features, and property descriptions,                                  #
# please review the GlobalConfig class reference in our TypeDoc:                                              #
# https://awslabs.github.io/landing-zone-accelerator-on-aws/latest/user-guide/config/#global-configuration    #
#                                                                                                             #
# This is a MINIMAL configuration for test/development environments.                                          #
# Many optional features have been disabled to reduce cost and complexity.                                    #
###############################################################################################################

homeRegion: "{{ HomeRegion }}"
enabledRegions: { { EnabledRegions } }
managementAccountAccessRole: AWSControlTowerExecution # Cross-account role for LZA resource orchestration

# Global Tags For Supported Resources
tags:
  - key: Accelerator
    value: "{{ AcceleratorPrefix }}"

# Enable v2 Networking Stacks (required for newer LZA features)
useV2Stacks: true

###############################################################################################################
# Amazon EventBridge Default Event Bus Configurations                                                         #
# REMOVED: Not needed without SNS alerts or cross-account event routing                                       #
# To re-enable, add:                                                                                          #
#   defaultEventBus:                                                                                          #
#     policy: event-bus-policies/event-bus-policy.json                                                        #
#     deploymentTargets:                                                                                      #
#       organizationalUnits:                                                                                  #
#         - Root                                                                                              #
###############################################################################################################

# CloudWatch Log Retention - Reduced for test environment cost savings
# Production recommendation: 365 days
cloudwatchLogRetentionInDays: 30

# CDK Options - Controls how CDK operates within LZA
cdkOptions:
  centralizeBuckets: true # Use single S3 bucket per region in management account for CDK assets
  useManagementAccessRole: true # Use managementAccountAccessRole instead of default CDK roles

# Stack Protection - Disabled for easier cleanup in test environment
# Production recommendation: true
terminationProtection: false

# Opt-in Regions - Disable automatic enablement of opt-in regions
enableOptInRegions: false

###############################################################################################################
# S3 Encryption Configuration                                                                                 #
# By default, LZA creates AWS KMS Customer Managed Keys (CMK) for S3 encryption.                              #
# Setting createCMK: false uses SSE-S3 (AWS managed keys) instead to reduce cost/complexity.                  #
# NOTE: Some buckets ALWAYS use CMK regardless of this setting:                                               #
#   - LZA Installer bucket                                                                                    #
#   - CodePipeline artifact bucket                                                                            #
#   - CentralLogs bucket in LogArchive account                                                                #
###############################################################################################################
s3:
  encryption:
    createCMK: false

###############################################################################################################
# Lambda Encryption Configuration                                                                             #
# By default, LZA creates CMK for Lambda environment variable encryption.                                     #
# Setting useCMK: false uses AWS managed keys instead.                                                        #
###############################################################################################################
lambda:
  encryption:
    useCMK: false

###############################################################################################################
# AWS Control Tower Configurations                                                                            #
# LZA integrates with Control Tower for account provisioning and governance.                                  #
# Ensure landingZone.version matches your deployed Control Tower version.                                     #
###############################################################################################################
controlTower:
  enable: true
  landingZone:
    version: "4.0" # Verify this matches your Control Tower version in AWS Console
    logging:
      loggingBucketRetentionDays: 30 # Reduced for test - Production: 365+
      accessLoggingBucketRetentionDays: 30 # Reduced for test - Production: 365+
      organizationTrail: true # Organization-wide CloudTrail managed by Control Tower
    security:
      enableIdentityCenterAccess: true # Enables AWS IAM Identity Center

  ###############################################################################################################
  # Control Tower Controls (Guardrails)                                                                         #
  # REMOVED: Additional controls beyond Control Tower defaults                                                  #
  # These are AWS Config rules that check for compliance. Each has cost implications.                           #
  # To re-enable, add controls with identifiers from:                                                           #
  # https://docs.aws.amazon.com/controltower/latest/controlreference/all-global-identifiers.html                #
  #                                                                                                             #
  # Example controls that were in the original config:                                                          #
  #   - CONFIG.CLOUDTRAIL.DT.5: CloudTrail logging S3 data events                                               #
  #   - CONFIG.LOGS.DT.1: CloudWatch Log Groups encrypted with KMS                                              #
  #   - CONFIG.IAM.DT.6: IAM groups have at least one user                                                      #
  #   - CONFIG.IAM.DT.5: Inline policies not in use                                                             #
  #   - CONFIG.EC2.DT.17: Internet gateways attached to authorized VPCs                                         #
  #   - AWS-GR_NO_UNRESTRICTED_ROUTE_TO_IGW: No public routes to IGW                                            #
  #   - CONFIG.SAGEMAKER.DT.3: SageMaker notebooks encrypted with KMS                                           #
  #   - CONFIG.SECURITYHUB.DT.1: Security Hub enabled                                                           #
  #   - BACKUP_PLAN_MIN_FREQUENCY_AND_MIN_RETENTION_CHECK: Backup frequency/retention                           #
  #   - BACKUP_RECOVERY_POINT_MANUAL_DELETION_DISABLED: Backup vault deletion protection                        #
  #   - CONFIG.EC2.DT.10: EC2 instances protected by backup plan                                                #
  ###############################################################################################################
  controls: []

###############################################################################################################
# AWS IAM Central Root User Management                                                                        #
# REMOVED: Disabled due to account migration from different AWS Organization                                  #
# This feature centralizes root credential management across member accounts.                                 #
# To re-enable after migration:                                                                               #
#   centralRootUserManagement:                                                                                #
#     enable: true                                                                                            #
#     capabilities:                                                                                           #
#       rootCredentialsManagement: true                                                                       #
#       allowRootSessions: true                                                                               #
###############################################################################################################

###############################################################################################################
# SNS Topics Configuration                                                                                    #
# REMOVED: Security alert notifications disabled for test environment                                         #
# To re-enable, add:                                                                                          #
#   snsTopics:                                                                                                #
#     deploymentTargets:                                                                                      #
#       accounts:                                                                                             #
#         - Management                                                                                        #
#     topics:                                                                                                 #
#       - name: SecurityHigh                                                                                  #
#         emailAddresses:                                                                                     #
#           - security-alerts@example.com                                                                     #
###############################################################################################################

###############################################################################################################
# AWS Backup Vault Configuration                                                                              #
# REMOVED: Backup vaults not needed for test environment                                                      #
# To re-enable, add:                                                                                          #
#   backup:                                                                                                   #
#     vaults:                                                                                                 #
#       - name: BackupVault                                                                                   #
#         deploymentTargets:                                                                                  #
#           organizationalUnits:                                                                              #
#             - Infrastructure                                                                                #
###############################################################################################################

###############################################################################################################
# Logging Configurations                                                                                      #
# Centralized logging is a core LZA feature. The LogArchive account aggregates logs.                          #
#                                                                                                             #
# CloudTrail Configuration:                                                                                   #
# In Control Tower environments, the organization-level CloudTrail trail is managed by Control Tower.         #
# LZA CloudTrail settings are DISABLED to avoid duplication and additional costs.                             #
# Enable account-specific CloudTrail configurations only if needed beyond CT's org trail.                     #
###############################################################################################################
logging:
  account: LogArchive # Centralizes log aggregation - must exist in accounts-config.yaml

  # CloudTrail - Disabled because Control Tower manages the organization trail
  cloudtrail:
    enable: false
    organizationTrail: false
    organizationTrailSettings:
      multiRegionTrail: false
      globalServiceEvents: false
      managementEvents: false
      s3DataEvents: false
      lambdaDataEvents: false
      sendToCloudWatchLogs: false
      apiErrorRateInsight: false
      apiCallRateInsight: false

  # Session Manager - Disabled for cost savings in test environment
  # This logs SSH/RDP sessions via AWS Systems Manager
  sessionManager:
    sendToCloudWatchLogs: false
    sendToS3: false
    # attachPolicyToIamRoles: # Removed - no EC2 instances in test
    #   - EC2-Default-SSM-Role

  ###############################################################################################################
  # CloudWatch Logs Dynamic Partitioning                                                                       #
  # REMOVED: Log streaming/filtering disabled for test environment                                             #
  # This feature uses Kinesis Data Streams to stream CloudWatch Logs to central S3.                            #
  # Cost components: Kinesis shards (~$0.015/shard-hour) + Firehose ($0.029/GB) + data transfer                 #
  # To re-enable, add:                                                                                         #
  #   cloudwatchLogs:                                                                                          #
  #     dynamicPartitioning: dynamic-partitioning/log-filters.json                                             #
  ###############################################################################################################

  # Access Log Bucket - S3 server access logs
  accessLogBucket:
    lifecycleRules:
      - enabled: true
        abortIncompleteMultipartUpload: 7
        expiration: 90 # Reduced for test - Production: 1000+
        noncurrentVersionExpiration: 90

  # Central Log Bucket - Aggregated logs from all accounts
  centralLogBucket:
    lifecycleRules:
      - enabled: true
        abortIncompleteMultipartUpload: 7
        expiration: 90
        noncurrentVersionExpiration: 90

###############################################################################################################
# ELB Log Bucket Configuration                                                                                #
# REMOVED: No load balancers in test environment (networking managed externally)                              #
# To re-enable, add:                                                                                          #
#   elbLogBucket:                                                                                             #
#     lifecycleRules:                                                                                         #
#       - enabled: true                                                                                       #
#         abortIncompleteMultipartUpload: 7                                                                   #
#         expiration: 365                                                                                     #
###############################################################################################################

###############################################################################################################
# AWS Cost and Usage Reports                                                                                  #
# REMOVED: CUR and Budgets disabled for test environment                                                      #
# To re-enable Cost and Usage Report:                                                                         #
#   reports:                                                                                                  #
#     costAndUsageReport:                                                                                     #
#       compression: Parquet                                                                                  #
#       format: Parquet                                                                                       #
#       reportName: accelerator-cur                                                                           #
#       s3Prefix: cur                                                                                         #
#       timeUnit: MONTHLY                                                                                     #
#       refreshClosedReports: true                                                                            #
#       reportVersioning: CREATE_NEW_REPORT                                                                   #
#                                                                                                             #
# To re-enable Budgets:                                                                                       #
#     budgets:                                                                                                #
#       - deploymentTargets:                                                                                  #
#           accounts:                                                                                         #
#             - Management                                                                                    #
#         name: monthly-budget                                                                                #
#         timeUnit: MONTHLY                                                                                   #
#         type: COST                                                                                          #
#         amount: 2000                                                                                        #
#         unit: USD                                                                                           #
###############################################################################################################

###############################################################################################################
# Accelerator Settings                                                                                        #
# NOT CONFIGURED: Using defaults                                                                              #
# maxConcurrentStacks controls parallel CloudFormation deployments.                                           #
# Default is 250. No cost impact - only affects deployment speed.                                             #
# For test environments with few accounts, default is sufficient.                                             #
#                                                                                                             #
#   acceleratorSettings:                                                                                      #
#     maxConcurrentStacks: 250                                                                                #
###############################################################################################################

###############################################################################################################
# SSM Inventory Configuration                                                                                 #
# NOT CONFIGURED: Optional feature to track EC2 instances and installed software                              #
# To enable:                                                                                                  #
#   ssmInventoryConfig:                                                                                       #
#     enable: true                                                                                            #
#     deploymentTargets:                                                                                      #
#       organizationalUnits:                                                                                  #
#         - Infrastructure                                                                                    #
###############################################################################################################

###############################################################################################################
# SSM Parameters                                                                                              #
# NOT CONFIGURED: Optional feature to deploy custom SSM parameters via LZA                                    #
# To enable:                                                                                                  #
#   ssmParameters:                                                                                            #
#     - deploymentTargets:                                                                                    #
#         organizationalUnits:                                                                                #
#           - Workloads                                                                                       #
#       parameters:                                                                                           #
#         - name: MyParameter                                                                                 #
#           path: /my/custom/path                                                                             #
#           value: 'MyValue'                                                                                  #
###############################################################################################################
